<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>计网 - Ep3 - 传输层「万字长文」丨学习记录 | 落雨乄天珀夜</title><meta name="author" content="落雨乄天珀夜"><meta name="copyright" content="落雨乄天珀夜"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Computer Networking A Top-Down Approach Learning Note Part 3  前言的前言：本篇尚未完结，图片均未上传至图床，有待更新，敬请期待。  前言： 本文是笔者初学计算机网络的笔记和一些心得，难免会有部分疏漏和错误，还请各位读者积极指出，不吝赐教。 有一些内容是笔者认为对自己暂时没那么重要的部分，就没有放上去，具体的内容可以查看相关的书籍。 观前">
<meta property="og:type" content="article">
<meta property="og:title" content="计网 - Ep3 - 传输层「万字长文」丨学习记录">
<meta property="og:url" content="https://conqueror712.github.io/post/Computer-Network-3.html">
<meta property="og:site_name" content="落雨乄天珀夜">
<meta property="og:description" content="Computer Networking A Top-Down Approach Learning Note Part 3  前言的前言：本篇尚未完结，图片均未上传至图床，有待更新，敬请期待。  前言： 本文是笔者初学计算机网络的笔记和一些心得，难免会有部分疏漏和错误，还请各位读者积极指出，不吝赐教。 有一些内容是笔者认为对自己暂时没那么重要的部分，就没有放上去，具体的内容可以查看相关的书籍。 观前">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01f67477a47c4d7db3a8c37602a9fcee~tplv-k3u1fbpfcp-watermark.image?">
<meta property="article:published_time" content="2023-04-20T06:39:28.000Z">
<meta property="article:modified_time" content="2023-04-26T01:51:28.395Z">
<meta property="article:author" content="落雨乄天珀夜">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01f67477a47c4d7db3a8c37602a9fcee~tplv-k3u1fbpfcp-watermark.image?"><link rel="shortcut icon" href="https://s2.loli.net/2023/02/15/LprEbGXq9xgfdDn.jpg"><link rel="canonical" href="https://conqueror712.github.io/post/Computer-Network-3"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计网 - Ep3 - 传输层「万字长文」丨学习记录',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-26 09:51:28'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="落雨乄天珀夜" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2023/02/15/LprEbGXq9xgfdDn.jpg" onerror="onerror=null;src='https://s2.loli.net/2023/02/15/gKRvwPCJqcN8Wiu.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01f67477a47c4d7db3a8c37602a9fcee~tplv-k3u1fbpfcp-watermark.image?')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">落雨乄天珀夜</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">计网 - Ep3 - 传输层「万字长文」丨学习记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-04-20T06:39:28.000Z" title="发表于 2023-04-20 14:39:28">2023-04-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-26T01:51:28.395Z" title="更新于 2023-04-26 09:51:28">2023-04-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/408/">408</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="计网 - Ep3 - 传输层「万字长文」丨学习记录"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><em>Computer Networking A Top-Down Approach Learning Note Part 3</em></p>
<blockquote>
<p>前言的前言：本篇尚未完结，图片均未上传至图床，有待更新，敬请期待。</p>
</blockquote>
<p><strong>前言</strong>：</p>
<p>本文是笔者初学计算机网络的笔记和一些心得，难免会有部分疏漏和错误，还请各位读者积极指出，不吝赐教。</p>
<p>有一些内容是笔者认为对自己暂时没那么重要的部分，就没有放上去，具体的内容可以查看相关的书籍。</p>
<p>观前提醒：本文篇幅较长，若您只是想看其中的某一小节的知识，直接点击目录进行跳转即可！</p>
<p>事不宜迟，我们开始吧！</p>
<blockquote>
<p>个人博客：<a href="https://conqueror712.github.io/">https://conqueror712.github.io/</a></p>
<p>知乎：<a target="_blank" rel="noopener" href="https://www.zhihu.com/people/soeur712/posts">https://www.zhihu.com/people/soeur712/posts</a></p>
<p>Bilibili：<a target="_blank" rel="noopener" href="https://space.bilibili.com/57089326">https://space.bilibili.com/57089326</a></p>
<p>掘金：<a target="_blank" rel="noopener" href="https://juejin.cn/user/1297878069809725/posts">https://juejin.cn/user/1297878069809725/posts</a></p>
</blockquote>
<p>注：本文图片的水印均是笔者自己的。</p>
<p>参考资料：《自顶向下的计算机网络》《王道计算机网络考研复习指导》</p>
<hr>
<h1 id="传输层概述"><a href="#传输层概述" class="headerlink" title="传输层概述"></a>传输层概述</h1><p>传输层，为<strong>运行在不同主机上的应用进程</strong>，提供<strong>直接的通信服务</strong>，起着至关重要的作用。</p>
<blockquote>
<p>Learning Target:</p>
</blockquote>
<p>传输层的工作原理：</p>
<ul>
<li>多路复用 &#x2F; 多路分解</li>
<li>可靠数据传输</li>
<li>流量控制</li>
<li>拥塞控制</li>
</ul>
<p>Internet的传输层协议：</p>
<ul>
<li>UDP：无连接传输</li>
<li>TCP：面向连接的可靠传输</li>
<li>TCP的拥塞控制</li>
</ul>
<hr>
<h2 id="概述和传输层服务："><a href="#概述和传输层服务：" class="headerlink" title="概述和传输层服务："></a>概述和传输层服务：</h2><blockquote>
<p>传输服务与协议</p>
</blockquote>
<p><strong>传输服务和协议</strong>目的：为运行在不同主机上的应用进程提供<strong>逻辑通信</strong>。</p>
<p>传输协议运行位置：端系统。</p>
<ul>
<li>发送方：将应用层来的报文分成<strong>报文段</strong>，然后继续传递给网络层。</li>
<li>接收方：将报文段重组成报文，然后继续传递给应用层。（相反的过程）</li>
</ul>
<p>还需注意的是，有很多传输层协议可以使用，对于Internet来说，就是TCP和UDP。</p>
<blockquote>
<p>我们来对比一下传输层和网络层的区别</p>
</blockquote>
<p>网络层服务：主机之间的逻辑通信。</p>
<p>传输层服务：进程之间的逻辑通信（更细）。</p>
<ul>
<li>传输层服务<strong>依赖于</strong>网络层的服务（延时和带宽，这两个不可以被加强）</li>
<li>传输层服务对网络层的服务进行<strong>增强</strong>（数据丢失、数据混乱、加密）</li>
</ul>
<p>笔者的理解：网络层建立起主机之间的逻辑通信之后，传输层才能在之上进行颗粒度更细的进程上的逻辑通信。</p>
<blockquote>
<p>Internet传输层协议</p>
</blockquote>
<p>TCP：</p>
<ul>
<li>多路复用、多路分解</li>
<li>建立连接</li>
<li>拥塞控制</li>
<li>流量控制</li>
</ul>
<p>UDP：</p>
<ul>
<li>多路复用、多路分解</li>
<li>没有为尽力而为的IP服务添加更多的额外服务</li>
</ul>
<hr>
<h2 id="传输层的寻址与端口："><a href="#传输层的寻址与端口：" class="headerlink" title="传输层的寻址与端口："></a>传输层的寻址与端口：</h2><h3 id="端口："><a href="#端口：" class="headerlink" title="端口："></a>端口：</h3><p>端口能够让应用层的各种应用进程将其数据通过端口<strong>向下交付</strong>给传输层，</p>
<p>以及让传输层知道应当将其报文段中的数据通过端口<strong>向上交付</strong>给应用层的相应进程。</p>
<p>端口是传输层服务访问点（T-SAP）；</p>
<p>（类比）端口在传输层的作用类似于IP地址在网络层的作用或MAC地址在数据链路层的作用；</p>
<p>不同的是，IP和MAC地址标识的是主机，而端口表示的是应用进程。</p>
<h3 id="端口号："><a href="#端口号：" class="headerlink" title="端口号："></a>端口号：</h3><p>应用进程通过端口号进行标识，端口号长度为$16bits$，能表示$65536$个不通的端口号。</p>
<p>应当注意的是，端口号只具有<strong>本地意义</strong>。</p>
<p><strong>端口号分类</strong>：</p>
<p>$[0, 1023]$的端口号称之为<strong>周知端口号</strong>，保留给HTTP(80)等周知应用层协议，由IANA指派。</p>
<p>$[1024, 49151]$的端口号称之为<strong>登记端口号</strong>，供没有周知端口号的应用程序使用，也需要在IANA上登记。</p>
<p>$[49152, 65535]$的端口号称之为<strong>临时端口</strong>，通信结束后，这些就会释放掉。</p>
<blockquote>
<p>IANA，互联网地址指派机构</p>
</blockquote>
<h3 id="套接字："><a href="#套接字：" class="headerlink" title="套接字："></a>套接字：</h3><p>$套接字Socket&#x3D;(IP地址:端口号)$</p>
<p>在网络中，采用发送方和接收方的套接字来识别端点，<strong>唯一地标识网络中的一台主机和其上的一个应用进程</strong>。</p>
<p>- </p>
<hr>
<h2 id="多路复用与多路分解："><a href="#多路复用与多路分解：" class="headerlink" title="多路复用与多路分解："></a>多路复用与多路分解：</h2><p>人话解释：就是将，由网络层提供的主机到主机的交付服务，延伸到，为运行在主机上的应用程序提供进程到进程的交付服务。</p>
<p>这是所有的计算机网络都需要的服务，而不仅仅是Internet独有的。</p>
<p>复习<strong>套接字</strong>：相当于网络和进程之间传递数据的门户。</p>
<blockquote>
<p>发送方主机——多路复用：</p>
</blockquote>
<p>含义：从多个套接字，接收来自多个进程的报文，根据套接字对应的<strong>IP地址和端口号</strong>等信息，对报文段<strong>用头部</strong>加以封装（该头部信息用于以后的解复用）。</p>
<blockquote>
<p>接收方主机——多路分解：</p>
</blockquote>
<p>含义：根据报文段的头部信息中的<strong>IP地址和端口号</strong>，将接收到的报文段发给正确的套接字（和对应的应用进程）。</p>
<ul>
<li>Port是端口号，用于区分进程</li>
<li>PID是进程的唯一标识</li>
</ul>
<p>如果还没有明白，可以仔细阅读这个例子 ：</p>
<p><img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230420190250662.png" alt="image-20230420190250662"></p>
<p>传输层多路复用的要求：</p>
<ol>
<li>套接字有唯一标识符；</li>
<li>每个报文段有特殊字段来指示该报文段所要交付到的套接字；</li>
</ol>
<hr>
<h3 id="无连接的多路复用与多路分解："><a href="#无连接的多路复用与多路分解：" class="headerlink" title="无连接的多路复用与多路分解："></a>无连接的多路复用与多路分解：</h3><p>一个UDP套接字是由一个<strong>二元组</strong>来全面标识的：</p>
<p>该二元组包含一个<strong>目的IP地址</strong>和一个<strong>目的端口号</strong>。</p>
<p>那么，源端口号还有存在的必要吗？答案是有的，源端口号作为<strong>返回地址</strong>的一部分。</p>
<img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230420200655593.png" alt="image-20230420200655593" style="zoom:67%;" />

<hr>
<h3 id="面向连接的多路复用与多路分解："><a href="#面向连接的多路复用与多路分解：" class="headerlink" title="面向连接的多路复用与多路分解："></a>面向连接的多路复用与多路分解：</h3><p>TCP套接字和UDP套接字的区别是，TCP套接字是由一个四元组来全面标识的：</p>
<p>四元组：源IP地址，源端口号，目的IP地址，目的端口号。</p>
<p>与UDP不同的是：</p>
<p>两个具有不同源IP地址或源端口号的到达TCP报文段将被定向到两个不同的套接字，除非TCP报文段携带了初始创建连接的请求。</p>
<blockquote>
<p>具体的细节并没有在此展开，笔者认为，一方面是因为写在一起过于纷繁复杂，不便于读者观看；另一方面是笔者自己也一时间看不下去那么多细节，所以就先Overview，之后在做题的过程中遇到问题再返回来查漏补缺。</p>
</blockquote>
<hr>
<p>Web服务器与TCP，先以一图以示之：</p>
<p><img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230421221520590.png" alt="image-20230421221520590"></p>
<hr>
<h1 id="无连接传输-UDP："><a href="#无连接传输-UDP：" class="headerlink" title="无连接传输 - UDP："></a>无连接传输 - UDP：</h1><h3 id="UDP介绍："><a href="#UDP介绍：" class="headerlink" title="UDP介绍："></a>UDP介绍：</h3><p>UDP的全称到底是什么？事实上是：User Datagram Protocol，即用户数据报协议。</p>
<p>UDP传的是数据报。</p>
<p>与IP一样，也是<strong>尽力而为</strong>的，除了相比IP，更加细分了进程到进程以外（IP是主机到主机），几乎没有额外的内容了。</p>
<p><img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230421221817030.png" alt="image-20230421221817030"></p>
<p><img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230421221830264.png" alt="image-20230421221830264"></p>
<hr>
<h3 id="UDP校验和："><a href="#UDP校验和：" class="headerlink" title="UDP校验和："></a>UDP校验和：</h3><p>校验和的目的：检测在被传输报文段中的差错（如比特反转）。</p>
<p><img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230421222011427.png" alt="image-20230421222011427"></p>
<p>关于可靠数据传输，我们要知道的是，可靠数据传输的实现问题不仅在传输层会出现，在链路层和应用层也会出现。</p>
<hr>
<h1 id="面向连接的传输-TCP："><a href="#面向连接的传输-TCP：" class="headerlink" title="面向连接的传输 - TCP："></a>面向连接的传输 - TCP：</h1><h2 id="TCP报文段："><a href="#TCP报文段：" class="headerlink" title="TCP报文段："></a>TCP报文段：</h2><p>报文段是什么：TCP传送的数据单元称为<strong>报文段</strong>。</p>
<p>TCP报文段用处：</p>
<ul>
<li>运载数据</li>
<li>建立连接、释放连接和应答</li>
</ul>
<blockquote>
<p>组成概述</p>
</blockquote>
<p>一个TCP报文段分为首部和数据两部分，整个TCP报文段作为IP数据报的数据部分封装在IP数据报中。</p>
<p>首部的前$20B$是固定的，TCP首部最短就为$20B$，后面有$4N$字节是根据需要而增加的选项，长度是$4B$的整数倍。</p>
<p>如图所示：</p>
<img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230424130045861.png" alt="image-20230424130045861" style="zoom: 67%;" />

<blockquote>
<p>各个字段的意义：（这部分有点多，但是大概是很重要的部分）</p>
</blockquote>
<h3 id="源端口和目的端口："><a href="#源端口和目的端口：" class="headerlink" title="源端口和目的端口："></a>源端口和目的端口：</h3><p>各占$2B$的大小。</p>
<p>端口是传输层与应用层的服务接口，传输层的<strong>复用</strong>和<strong>分用</strong>功能都要通过端口实现。</p>
<h3 id="序号："><a href="#序号：" class="headerlink" title="序号："></a>序号：</h3><p>占$4B$的大小，范围是$[0, 2^{32}-1]$，共$2^{32}$个序号。</p>
<p>（有的地方也称之为序列号，反正都是Sequence Number）</p>
<p>TCP为每个报文段分配一个序列号，<strong>用于报文段的重组和丢失检测</strong>。</p>
<p>∵TCP是面向字节流的（即TCP传送时时逐个字节传送的）</p>
<p>∴TCP连接传送的字节流中的<strong>每个字节都按顺序编号</strong>，</p>
<p>序号字段的值指的是本报文段所发送的数据的第一个字节的序号（类似于首地址）。</p>
<h3 id="确认号："><a href="#确认号：" class="headerlink" title="确认号："></a>确认号：</h3><p>占$4B$的大小，是<strong>期望</strong>收到对方<strong>下一个</strong>报文段的<strong>第一个</strong>数据字节的序号。</p>
<p>若确认号为$N$则说明序号到$N-1$为止的所有数据都已正确收到。</p>
<h3 id="数据偏移（首部长度）："><a href="#数据偏移（首部长度）：" class="headerlink" title="数据偏移（首部长度）："></a>数据偏移（首部长度）：</h3><p>占$4bits$， 首部长度指出TCP报文段的<strong>数据起始处</strong>距离TCP报文段的<strong>起始处</strong>有多远。</p>
<p>∵数据偏移的<strong>单位</strong>是$32bits$，即$4B$；</p>
<p>又∵$4$位二进制数能表示的最大值为$15$；</p>
<p>∴TCP首部的最大长度为$60B$。</p>
<blockquote>
<p>这里如果没理解的话可以看如下解释：</p>
<p>首部长度字段占4比特,最大值为15。但是这个15不是直接表示15个字节,而是表示15 * 4 &#x3D; 60个字节。<br>这是因为TCP报文段采用32位定界长度的格式,所以所有的字段都必须是4字节对齐的。所以当首部长度字段的值是1时,代表首部4字节;当值为2时,代表首部8字节;以此类推,最大值为15时,代表首部15 * 4 &#x3D; 60字节。</p>
</blockquote>
<h3 id="保留："><a href="#保留：" class="headerlink" title="保留："></a>保留：</h3><p>占$6bits$，目前置零。</p>
<h3 id="紧急位URG："><a href="#紧急位URG：" class="headerlink" title="紧急位URG："></a>紧急位URG：</h3><p>当<code>URG == 1</code>时，表明<strong>紧急指针字段</strong>有效，它告诉系统此报文段中有紧急数据，应当<strong>尽快传送</strong>。</p>
<p>不过，需要注意的是，URG需要配合首部中紧急指针字段（后续会介绍）使用，</p>
<p>即，数据<strong>从第一个字节到紧急指针所指的字节就是紧急数据</strong>。</p>
<h3 id="确认位ACK："><a href="#确认位ACK：" class="headerlink" title="确认位ACK："></a>确认位ACK：</h3><p>当<code>ACK == 1</code>时，<strong>确认号字段</strong>才有效。</p>
<p>TCP规定，在连接建立之后，所有传送的报文段都必须把ACK置1。</p>
<h3 id="推送位PSH："><a href="#推送位PSH：" class="headerlink" title="推送位PSH："></a>推送位PSH：</h3><p>当接收方TCP收到<code>PSH == 1</code>的报文段，就会<strong>尽快地交付</strong>给接收应用进程，而不是等到整个缓存都填满了再向上交付。</p>
<h3 id="复位位RST："><a href="#复位位RST：" class="headerlink" title="复位位RST："></a>复位位RST：</h3><p>当<code>RST == 1</code>时，表明TCP连接中出现严重差错，必须<strong>释放连接</strong>，然后再重新建立连接。</p>
<h3 id="同步位SYN："><a href="#同步位SYN：" class="headerlink" title="同步位SYN："></a>同步位SYN：</h3><p>当<code>SYN == 1</code>时，表示这是一个<strong>连接请求</strong> or <strong>连接接受</strong>的报文。</p>
<p>当<code>SYN == 1 &amp;&amp; ACK == 0</code>时，说明这是一个连接请求报文（还没建立连接），</p>
<p>若对方同意建立连接，则在响应报文中为<code>SYN == 1 &amp;&amp; ACK == 1</code>。</p>
<h3 id="终止位FIN："><a href="#终止位FIN：" class="headerlink" title="终止位FIN："></a>终止位FIN：</h3><p>用来<strong>释放一个连接</strong>，当<code>FIN == 1</code>时，说明此报文段的发送方的数据已经发送完毕，并要求释放连接。</p>
<h3 id="窗口："><a href="#窗口：" class="headerlink" title="窗口："></a>窗口：</h3><p>占$2B$，范围为$[0, 2^{16}-1]$。</p>
<p>它指的是，现在允许对方发送的数据量，这是因为接收方的数据缓存空间是有限的，</p>
<p>这个窗口值可以作为接收方让发送方设置其发送窗口大小的依据。</p>
<h3 id="校验和："><a href="#校验和：" class="headerlink" title="校验和："></a>校验和：</h3><p>占$2B$，校验和字段检验的范围包括首部和数据两部分。</p>
<p>与UDP一样，在计算校验和时，要在TCP报文段的前面加上$12B$的伪首部，具体来说：</p>
<ul>
<li>将UDP伪首部的协议字段的$17$改成$6$</li>
<li>UDP长度字段改成TCP长度</li>
</ul>
<p>其他的都和UDP一样。</p>
<h3 id="紧急指针："><a href="#紧急指针：" class="headerlink" title="紧急指针："></a>紧急指针：</h3><p>占$2B$，如上文，指出本报文段中紧急数据共多少字节。</p>
<h3 id="选项："><a href="#选项：" class="headerlink" title="选项："></a>选项：</h3><p>长度可变。</p>
<p>TCP最初只规定了一种选项，即**最大报文段长度Maximum Segment Size(MSS)**，</p>
<p>MSS是TCP报文段中的<strong>数据字段</strong>的最大长度。</p>
<h3 id="填充："><a href="#填充：" class="headerlink" title="填充："></a>填充：</h3><p>这是为了是整个首部长度是$4B$的整数倍而设置的。</p>
<hr>
<h2 id="TCP连接管理："><a href="#TCP连接管理：" class="headerlink" title="TCP连接管理："></a>TCP连接管理：</h2><hr>
<h2 id="TCP流量控制："><a href="#TCP流量控制：" class="headerlink" title="TCP流量控制："></a>TCP流量控制：</h2><blockquote>
<p>下面以<strong>数据链路层</strong>的流量控制与可靠传输机制进行说明，在传输层也类似。</p>
</blockquote>
<p>流量控制涉及对链路上的帧的<strong>发送速率的控制</strong>，以便接收方有足够的缓冲空间来接收每个帧。</p>
<p>流量控制的基本方法是<strong>由接收方控制发送方发送数据的速率</strong>。</p>
<p>流量控制的两种常见方式：</p>
<ul>
<li>停止-等待协议</li>
<li>滑动窗口协议</li>
</ul>
<h3 id="停止-等待-SW-流量控制基本原理："><a href="#停止-等待-SW-流量控制基本原理：" class="headerlink" title="停止-等待(SW)流量控制基本原理："></a>停止-等待(SW)流量控制基本原理：</h3><blockquote>
<p>一句话描述Stop-and-Wait：</p>
</blockquote>
<p>发送方每发送一帧，都要等待接收方的应答信号，之后<strong>才能</strong>发送下一帧；</p>
<p>接收方每接收一帧，都要反馈一个应答信号，表示可接收下一帧，若接收方不反馈应答信号，则发送方必须一直等待。</p>
<p>这样每次只发送一帧，然后陷入等待的这种过程，传输效率很低。</p>
<p><em>借用我初中年级主任的一句话：人生就是在这样你等我，我等他的过程中被浪费掉了。</em></p>
<hr>
<h3 id="滑动窗口流量控制基本原理："><a href="#滑动窗口流量控制基本原理：" class="headerlink" title="滑动窗口流量控制基本原理："></a>滑动窗口流量控制基本原理：</h3><p>滑动窗口分为两个窗口：</p>
<ul>
<li>发送窗口：在任意时刻，发送方维持一组连续的，允许发送的帧的序号。</li>
<li>接收窗口：在任意时刻，接收方维持一组连续的，允许接收的帧的序号。</li>
</ul>
<p>$W_T$表示在还未收到对方确认信息的情况下，发送方最多还可以发送多少个数据帧，$W_R$的道理类似。</p>
<p>有如下例：</p>
<img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230423132618032.png" alt="image-20230423132618032" style="zoom: 80%;" />

<blockquote>
<p>那么，窗口具体是如何滑动的呢？</p>
</blockquote>
<p>发送端每收到一个确认帧，发送窗口就向前滑动一个帧的位置；当发送窗口内没有可以发送的帧（即窗口内的帧全是已发送但未收到确认的帧）时，发送方就会停止发送，直到收到接收方发送的确认帧，使得窗口移动，移动之后，窗口内有了新的可以发送的帧，才开始继续发送。</p>
<p>接收端收到数据帧后，将窗口向前移动一个位置，并发回确认帧，若收到的数据帧落在接收窗口之外，则一律丢弃。</p>
<blockquote>
<p>好，那么滑动窗口有什么重要的特性吗？</p>
</blockquote>
<ol>
<li>只有接收窗口向前滑动，且接收方发送了确认帧时，发送窗口才有可能向前滑动（得收到确认帧）。</li>
<li>停止-等待协议、GBN协议和SR协议只在发送窗口与接收窗口的<strong>大小</strong>上有所差别：<ul>
<li>SW：发送窗口大小 &#x3D; 接收窗口大小 &#x3D; 1</li>
<li>GBN：发送窗口大小 &gt; 1，接收窗口大小 &#x3D; 1</li>
<li>SR：发送窗口大小 &gt; 1，接收窗口大小 &gt; 1</li>
</ul>
</li>
<li>只有接收窗口大小为1时，才能保证帧的<strong>有序接收</strong>。</li>
<li>数据链路层的滑动窗口大小在传输过程中时固定的，而传输层的则不是。</li>
</ol>
<h2 id="TCP可靠传输："><a href="#TCP可靠传输：" class="headerlink" title="TCP可靠传输："></a>TCP可靠传输：</h2><p>数据链路层的可靠传输使用<strong>确认</strong>和<strong>超时重传</strong>两种机制来完成。</p>
<ul>
<li><p>确认：</p>
<p>  是一种无数据的控制帧，使得接收方可以让发送方知道哪些内容被正确接收；</p>
<p>  有时为了图方便，会将确认捎带在一个回复帧中，称为<strong>捎带确认</strong>。</p>
</li>
<li><p>超时重传：</p>
<p>  指发送方在发送某个数据帧后就开启一个计时器⏲，在一定的时间内，如果没有得到发送的数据帧的确认帧，那就重新发送该数据帧，直到发送成功为止。</p>
</li>
</ul>
<blockquote>
<p>那么问题来了，当数据帧传输到了以后出错了怎么办呢？答案是ARQ。</p>
</blockquote>
<p>自动重传请求（Automatic Repeat reQuest, ARQ）：</p>
<p>通过接收方请求发送方重传出错的数据帧，来恢复出错的帧。</p>
<p>传统自动重传请求分为三种：</p>
<ul>
<li>SW-ARQ</li>
<li>GBN-ARQ</li>
<li>SR-ARQ</li>
</ul>
<p>后两者是滑动窗口技术与请求重传技术的结合。</p>
<blockquote>
<p>我们暂且先了解这么多，更多的细节会在数据链路层中展现，敬请期待。</p>
</blockquote>
<hr>
<h2 id="TCP拥塞控制："><a href="#TCP拥塞控制：" class="headerlink" title="TCP拥塞控制："></a>TCP拥塞控制：</h2><p>拥塞控制的意义：</p>
<p>防止过多的数据注入网络，保证网络中的路由器或链路<strong>不至于过载</strong>。</p>
<h3 id="关于拥塞："><a href="#关于拥塞：" class="headerlink" title="关于拥塞："></a>关于拥塞：</h3><p>当拥塞出现的时候，端点实际上并不了解拥塞发生的细节，对于通信连接的端点来说，只能”观察”到其现象，即通信时延的增加。</p>
<p>我们考虑以下这个例子：</p>
<p><img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230422233230436.png" alt="image-20230422233230436"></p>
<hr>
<h3 id="控制与流量控制的区别："><a href="#控制与流量控制的区别：" class="headerlink" title="控制与流量控制的区别："></a>控制与流量控制的区别：</h3><p>拥塞控制：<strong>全局性</strong>的过程，让网络能够承受现有的网络负荷，涉及所有的主机、路由器以及与降低网络传输性能有关的所有因素。</p>
<p>流量控制：<strong>局部性</strong>的过程，是端到端的问题，与拥塞控制一样，是<strong>通过控制发送方发送数据的速率来达到控制效果</strong>。</p>
<hr>
<h3 id="两个窗口："><a href="#两个窗口：" class="headerlink" title="两个窗口："></a>两个窗口：</h3><p>TCP为什么要有两个窗口呢？</p>
<p>事实上，这是因为发送方在确定发送报文段的速率的时候，既要考虑接收方的接收能力，又要从全局考虑不要使网络发生拥塞。</p>
<ol>
<li><p>接收窗口rwnd：</p>
<p> <strong>接收方</strong>根据<strong>目前接收缓存大小</strong>所许诺的最新窗口值，反映<strong>接收方的容量</strong>。</p>
<p> 由接收方根据其放在TCP报文的首部的窗口字段，通知对方。</p>
</li>
<li><p>拥塞窗口cwnd：</p>
<p> <strong>发送方</strong>根据自己估算的<strong>网络拥塞程度</strong>而设置的窗口值，反映<strong>网络的当前容量</strong>。</p>
<p> 只要网络未出现拥塞，拥塞窗口就可以再大一些，以便把更多的分组发送出去，反之，一旦出现网络拥塞，拥塞窗口就会减小一些，以限制注入网络的分组数。</p>
</li>
</ol>
<p>这两者有一个上限：</p>
<p>$发送窗口的上限值 &#x3D; min[rwnd, cwnd]$</p>
<p>然而，接收窗口的大小是根据TCP报文首部的窗口字段通知发送方的，但是发送方该如何维护拥塞窗口呢？这时候就需要慢开始和拥塞避免算法了，请看下文。</p>
<blockquote>
<p>当然，上述条件成立的前提是，我们假设了接收方总是有足够大的缓存空间；</p>
<p>基于此，发送窗口的大小由网络的拥塞程度决定，故而等效为拥塞窗口。</p>
</blockquote>
<hr>
<h3 id="四种拥塞控制的算法："><a href="#四种拥塞控制的算法：" class="headerlink" title="四种拥塞控制的算法："></a>四种拥塞控制的算法：</h3><p>慢开始、拥塞避免、快重传、快恢复。</p>
<p>这四种算法是同时运用的。</p>
<blockquote>
<p>一句话概括：</p>
</blockquote>
<p>在TCP连接建立和网络出现超时的时候，采用慢开始和拥塞避免算法；</p>
<p>当发送方接收到冗余ACK时，采用快重传和快恢复算法。</p>
<h4 id="慢开始算法："><a href="#慢开始算法：" class="headerlink" title="慢开始算法："></a>慢开始算法：</h4><blockquote>
<p>一句话解释算法：</p>
</blockquote>
<p>在TCP刚刚连接好并开始发送TCP报文段时，先令拥塞窗口cwnd &#x3D; 1，即一个最大报文段长度MSS；</p>
<p>每当接收到一个对新报文段的确认后，cwnd++，即增大一个MSS；</p>
<p>这样逐步增大发送方的cwnd，可以使分组注入网络的速率更加合理。</p>
<blockquote>
<p>慢开始的慢到底是什么意思</p>
</blockquote>
<p>其实，这个慢的意思是一开始先不着急用很大的窗口来发送报文段，初始时，cwnd &#x3D; 1的效果类似于”试探”。</p>
<p>这就是慢的含义——花费一点时间来慢慢的进入正题。</p>
<p>使用慢开始算法后，每经过一个传输轮次RTT，cwnd就会加倍，也就是说是指数规律增长，这样一来，慢开始就会一直把cwnd增大到一个规定的<strong>慢开始门限ssthresh（阈值）</strong>，然后改用拥塞避免算法。</p>
<blockquote>
<p>所谓RTT，就是往返时延Round-Trip Time</p>
<p>是指网络通信中一个数据包从发送端发送到接收端，再从接收端返回到发送端所需的时间。</p>
<p>在计算机网络中，往返时延是一个重要的网络性能指标，可以反映出网络的响应速度和稳定性。当我们在浏览网页、发送邮件、进行在线游戏等网络操作时，RTT 往返时延会直接影响我们的体验。较低的 RTT 往返时延可以提高网络响应速度和传输效率，较高的 RTT 往返时延则会导致网络传输变慢、卡顿、延迟等问题。</p>
</blockquote>
<h4 id="拥塞避免算法："><a href="#拥塞避免算法：" class="headerlink" title="拥塞避免算法："></a>拥塞避免算法：</h4><blockquote>
<p>一句话解释算法：</p>
</blockquote>
<p>每经过一个RTT，就让cwnd++，而不是加倍，使得cwnd线性缓慢增长。</p>
<p>据此，我们可以知道：</p>
<ul>
<li>if (cwnd &lt; ssthresh): use 慢开始算法</li>
<li>if (cwnd &gt; ssthresh): use 拥塞避免算法</li>
<li>if (cwnd &#x3D;&#x3D; ssthresh): use 慢开始算法 or 拥塞避免算法（一般来说是用拥塞避免算法）</li>
</ul>
<h4 id="网络拥塞的处理过程："><a href="#网络拥塞的处理过程：" class="headerlink" title="网络拥塞的处理过程："></a>网络拥塞的处理过程：</h4><p>无论是哪个阶段，只要发送方判断网络出现拥塞（未按时收到确认ACK），</p>
<p>就要把慢开始门限ssthresh设置为<strong>出现拥塞时的发送方的cwnd值的一半</strong>（但不能小于2），</p>
<p>然后，把cwnd重新设置为1，继续执行慢开始算法。</p>
<blockquote>
<p>特别地，在慢开始阶段，若2cwnd&gt;ssthresh，则令下一个RTT后的cwnd&#x3D;ssthresh而不是2cwnd。</p>
</blockquote>
<p>如例图所示：</p>
<p><img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230423100833567.png" alt="image-20230423100833567"></p>
<p>然而，需要注意的是，这两种算法都不能完全避免拥塞，只是可以缓解拥塞。</p>
<blockquote>
<p>所谓ACK，是指确认（Acknowledgment）的缩写，它是一种用于确认收到数据的信号。在TCP&#x2F;IP协议中，当一个计算机接收到另一个计算机发送的数据包时，会向发送方发送一个ACK信号，表示已经成功接收到数据。这个ACK信号是由接收方发送给发送方的，以告诉发送方数据已经被正确接收。在TCP协议中，发送方会等待一个ACK信号来确认数据已经被成功接收，如果在一定时间内没有收到ACK信号，就会认为数据包丢失或损坏，然后重新发送数据。因此，ACK在计算机网络中非常重要，它能够确保数据的可靠传输。</p>
</blockquote>
<hr>
<p>快重传和快恢复算法是对慢开始和拥塞避免算法的改进。</p>
<h4 id="快重传："><a href="#快重传：" class="headerlink" title="快重传："></a>快重传：</h4><blockquote>
<p>一句话解释算法：</p>
</blockquote>
<p>我们已经知道的是，TCP可靠传输机制中，利用了快重传技术，通过冗余ACK来检测丢包的发生。</p>
<p>在这里，我们利用冗余ACK来检测网络的拥塞，其实是同一套道理（因为丢了包不就意味着网络可能出现了拥塞嘛）。</p>
<p>快重传并不是取消了重传计时器，而是在某些情况下更早地重传丢失的报文段。</p>
<p>当发送方<strong>连续收到三个重复的ACK</strong>时，<strong>直接重传</strong>对方尚未接收到的报文段，而<strong>不必等待</strong>那个报文段设置的重传计时器超时。</p>
<h4 id="快恢复："><a href="#快恢复：" class="headerlink" title="快恢复："></a>快恢复：</h4><blockquote>
<p>一句话解释算法：</p>
</blockquote>
<p>当发送方连续收到三个冗余ACK时，把慢开始门限ssthresh设置为此时cwnd的一半，这是为了预防网络发生拥塞。</p>
<p>这一过程与慢开始有点类似，但是不同的是，快恢复会把cwnd值设置为慢开始门限ssthresh改变后的数值，而不是1，然后直接开始进行拥塞避免算法。如下图例子所示：</p>
<p><img src="C:\Users\22562\AppData\Roaming\Typora\typora-user-images\image-20230423105147786.png" alt="image-20230423105147786"></p>
<hr>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://conqueror712.github.io">落雨乄天珀夜</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://conqueror712.github.io/post/Computer-Network-3.html">https://conqueror712.github.io/post/Computer-Network-3.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://conqueror712.github.io" target="_blank">落雨乄天珀夜</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01f67477a47c4d7db3a8c37602a9fcee~tplv-k3u1fbpfcp-watermark.image?" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/Interview-BUPT.html"><img class="prev-cover" src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9906557577504b17a327378fc9834891~tplv-k3u1fbpfcp-watermark.image?" onerror="onerror=null;src='https://s2.loli.net/2023/02/15/gKRvwPCJqcN8Wiu.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">面经丨BUPT第三届模拟面试大赛</div></div></a></div><div class="next-post pull-right"><a href="/post/Neo4j-3.html"><img class="next-cover" src="https://cdnjson.com/images/2023/04/09/wallhaven-qzj8ol.jpg" onerror="onerror=null;src='https://s2.loli.net/2023/02/15/gKRvwPCJqcN8Wiu.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Neo4j - Ep3丨学习记录</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2023/02/15/LprEbGXq9xgfdDn.jpg" onerror="this.onerror=null;this.src='https://s2.loli.net/2023/02/15/gKRvwPCJqcN8Wiu.jpg'" alt="avatar"/></div><div class="author-info__name">落雨乄天珀夜</div><div class="author-info__description">「落花人独立丨微雨燕双飞」</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Conqueror712"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog ~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">传输层概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0%E5%92%8C%E4%BC%A0%E8%BE%93%E5%B1%82%E6%9C%8D%E5%8A%A1%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">概述和传输层服务：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82%E7%9A%84%E5%AF%BB%E5%9D%80%E4%B8%8E%E7%AB%AF%E5%8F%A3%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">传输层的寻址与端口：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%EF%BC%9A"><span class="toc-number">1.2.1.</span> <span class="toc-text">端口：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E5%8F%B7%EF%BC%9A"><span class="toc-number">1.2.2.</span> <span class="toc-text">端口号：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97%EF%BC%9A"><span class="toc-number">1.2.3.</span> <span class="toc-text">套接字：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E4%B8%8E%E5%A4%9A%E8%B7%AF%E5%88%86%E8%A7%A3%EF%BC%9A"><span class="toc-number">1.3.</span> <span class="toc-text">多路复用与多路分解：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E8%BF%9E%E6%8E%A5%E7%9A%84%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E4%B8%8E%E5%A4%9A%E8%B7%AF%E5%88%86%E8%A7%A3%EF%BC%9A"><span class="toc-number">1.3.1.</span> <span class="toc-text">无连接的多路复用与多路分解：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E4%B8%8E%E5%A4%9A%E8%B7%AF%E5%88%86%E8%A7%A3%EF%BC%9A"><span class="toc-number">1.3.2.</span> <span class="toc-text">面向连接的多路复用与多路分解：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A0%E8%BF%9E%E6%8E%A5%E4%BC%A0%E8%BE%93-UDP%EF%BC%9A"><span class="toc-number">2.</span> <span class="toc-text">无连接传输 - UDP：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UDP%E4%BB%8B%E7%BB%8D%EF%BC%9A"><span class="toc-number">2.0.1.</span> <span class="toc-text">UDP介绍：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UDP%E6%A0%A1%E9%AA%8C%E5%92%8C%EF%BC%9A"><span class="toc-number">2.0.2.</span> <span class="toc-text">UDP校验和：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E4%BC%A0%E8%BE%93-TCP%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">面向连接的传输 - TCP：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E6%8A%A5%E6%96%87%E6%AE%B5%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">TCP报文段：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%AB%AF%E5%8F%A3%E5%92%8C%E7%9B%AE%E7%9A%84%E7%AB%AF%E5%8F%A3%EF%BC%9A"><span class="toc-number">3.1.1.</span> <span class="toc-text">源端口和目的端口：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%8F%E5%8F%B7%EF%BC%9A"><span class="toc-number">3.1.2.</span> <span class="toc-text">序号：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E8%AE%A4%E5%8F%B7%EF%BC%9A"><span class="toc-number">3.1.3.</span> <span class="toc-text">确认号：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%81%8F%E7%A7%BB%EF%BC%88%E9%A6%96%E9%83%A8%E9%95%BF%E5%BA%A6%EF%BC%89%EF%BC%9A"><span class="toc-number">3.1.4.</span> <span class="toc-text">数据偏移（首部长度）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E7%95%99%EF%BC%9A"><span class="toc-number">3.1.5.</span> <span class="toc-text">保留：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A7%E6%80%A5%E4%BD%8DURG%EF%BC%9A"><span class="toc-number">3.1.6.</span> <span class="toc-text">紧急位URG：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E8%AE%A4%E4%BD%8DACK%EF%BC%9A"><span class="toc-number">3.1.7.</span> <span class="toc-text">确认位ACK：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A8%E9%80%81%E4%BD%8DPSH%EF%BC%9A"><span class="toc-number">3.1.8.</span> <span class="toc-text">推送位PSH：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E4%BD%8D%E4%BD%8DRST%EF%BC%9A"><span class="toc-number">3.1.9.</span> <span class="toc-text">复位位RST：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E6%AD%A5%E4%BD%8DSYN%EF%BC%9A"><span class="toc-number">3.1.10.</span> <span class="toc-text">同步位SYN：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%88%E6%AD%A2%E4%BD%8DFIN%EF%BC%9A"><span class="toc-number">3.1.11.</span> <span class="toc-text">终止位FIN：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%EF%BC%9A"><span class="toc-number">3.1.12.</span> <span class="toc-text">窗口：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%A1%E9%AA%8C%E5%92%8C%EF%BC%9A"><span class="toc-number">3.1.13.</span> <span class="toc-text">校验和：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A7%E6%80%A5%E6%8C%87%E9%92%88%EF%BC%9A"><span class="toc-number">3.1.14.</span> <span class="toc-text">紧急指针：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E9%A1%B9%EF%BC%9A"><span class="toc-number">3.1.15.</span> <span class="toc-text">选项：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A1%AB%E5%85%85%EF%BC%9A"><span class="toc-number">3.1.16.</span> <span class="toc-text">填充：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E8%BF%9E%E6%8E%A5%E7%AE%A1%E7%90%86%EF%BC%9A"><span class="toc-number">3.2.</span> <span class="toc-text">TCP连接管理：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%EF%BC%9A"><span class="toc-number">3.3.</span> <span class="toc-text">TCP流量控制：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%9C%E6%AD%A2-%E7%AD%89%E5%BE%85-SW-%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%EF%BC%9A"><span class="toc-number">3.3.1.</span> <span class="toc-text">停止-等待(SW)流量控制基本原理：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%EF%BC%9A"><span class="toc-number">3.3.2.</span> <span class="toc-text">滑动窗口流量控制基本原理：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E5%8F%AF%E9%9D%A0%E4%BC%A0%E8%BE%93%EF%BC%9A"><span class="toc-number">3.4.</span> <span class="toc-text">TCP可靠传输：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6%EF%BC%9A"><span class="toc-number">3.5.</span> <span class="toc-text">TCP拥塞控制：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E6%8B%A5%E5%A1%9E%EF%BC%9A"><span class="toc-number">3.5.1.</span> <span class="toc-text">关于拥塞：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E4%B8%8E%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9A"><span class="toc-number">3.5.2.</span> <span class="toc-text">控制与流量控制的区别：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E7%AA%97%E5%8F%A3%EF%BC%9A"><span class="toc-number">3.5.3.</span> <span class="toc-text">两个窗口：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E7%A7%8D%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6%E7%9A%84%E7%AE%97%E6%B3%95%EF%BC%9A"><span class="toc-number">3.5.4.</span> <span class="toc-text">四种拥塞控制的算法：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%85%A2%E5%BC%80%E5%A7%8B%E7%AE%97%E6%B3%95%EF%BC%9A"><span class="toc-number">3.5.4.1.</span> <span class="toc-text">慢开始算法：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%A5%E5%A1%9E%E9%81%BF%E5%85%8D%E7%AE%97%E6%B3%95%EF%BC%9A"><span class="toc-number">3.5.4.2.</span> <span class="toc-text">拥塞避免算法：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%8B%A5%E5%A1%9E%E7%9A%84%E5%A4%84%E7%90%86%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">3.5.4.3.</span> <span class="toc-text">网络拥塞的处理过程：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BF%AB%E9%87%8D%E4%BC%A0%EF%BC%9A"><span class="toc-number">3.5.4.4.</span> <span class="toc-text">快重传：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BF%AB%E6%81%A2%E5%A4%8D%EF%BC%9A"><span class="toc-number">3.5.4.5.</span> <span class="toc-text">快恢复：</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/Interview-BUPT.html" title="面经丨BUPT第三届模拟面试大赛"><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9906557577504b17a327378fc9834891~tplv-k3u1fbpfcp-watermark.image?" onerror="this.onerror=null;this.src='https://s2.loli.net/2023/02/15/gKRvwPCJqcN8Wiu.jpg'" alt="面经丨BUPT第三届模拟面试大赛"/></a><div class="content"><a class="title" href="/post/Interview-BUPT.html" title="面经丨BUPT第三届模拟面试大赛">面经丨BUPT第三届模拟面试大赛</a><time datetime="2023-04-26T15:32:52.000Z" title="发表于 2023-04-26 23:32:52">2023-04-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Computer-Network-3.html" title="计网 - Ep3 - 传输层「万字长文」丨学习记录"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01f67477a47c4d7db3a8c37602a9fcee~tplv-k3u1fbpfcp-watermark.image?" onerror="this.onerror=null;this.src='https://s2.loli.net/2023/02/15/gKRvwPCJqcN8Wiu.jpg'" alt="计网 - Ep3 - 传输层「万字长文」丨学习记录"/></a><div class="content"><a class="title" href="/post/Computer-Network-3.html" title="计网 - Ep3 - 传输层「万字长文」丨学习记录">计网 - Ep3 - 传输层「万字长文」丨学习记录</a><time datetime="2023-04-20T06:39:28.000Z" title="发表于 2023-04-20 14:39:28">2023-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Neo4j-3.html" title="Neo4j - Ep3丨学习记录"><img src="https://cdnjson.com/images/2023/04/09/wallhaven-qzj8ol.jpg" onerror="this.onerror=null;this.src='https://s2.loli.net/2023/02/15/gKRvwPCJqcN8Wiu.jpg'" alt="Neo4j - Ep3丨学习记录"/></a><div class="content"><a class="title" href="/post/Neo4j-3.html" title="Neo4j - Ep3丨学习记录">Neo4j - Ep3丨学习记录</a><time datetime="2023-04-09T05:21:28.000Z" title="发表于 2023-04-09 13:21:28">2023-04-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/DL-CNN.html" title="深度学习 - Ep4 - 卷积神经网络丨学习记录"><img src="https://picx.zhimg.com/v2-b7e4abd246f59a7ced519e2deebc810a_1440w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='https://s2.loli.net/2023/02/15/gKRvwPCJqcN8Wiu.jpg'" alt="深度学习 - Ep4 - 卷积神经网络丨学习记录"/></a><div class="content"><a class="title" href="/post/DL-CNN.html" title="深度学习 - Ep4 - 卷积神经网络丨学习记录">深度学习 - Ep4 - 卷积神经网络丨学习记录</a><time datetime="2023-04-08T11:48:55.000Z" title="发表于 2023-04-08 19:48:55">2023-04-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Neo4j-2.html" title="Neo4j - Ep2丨学习记录"><img src="https://cdnjson.com/images/2023/04/02/wallhaven-7p9o6v.jpg" onerror="this.onerror=null;this.src='https://s2.loli.net/2023/02/15/gKRvwPCJqcN8Wiu.jpg'" alt="Neo4j - Ep2丨学习记录"/></a><div class="content"><a class="title" href="/post/Neo4j-2.html" title="Neo4j - Ep2丨学习记录">Neo4j - Ep2丨学习记录</a><time datetime="2023-04-02T01:46:08.000Z" title="发表于 2023-04-02 09:46:08">2023-04-02</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01f67477a47c4d7db3a8c37602a9fcee~tplv-k3u1fbpfcp-watermark.image?')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 落雨乄天珀夜</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>